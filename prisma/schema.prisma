generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = "postgresql://postgres:joVEXEwZGmukMdXfygxyhtsRciskaxQt@shortline.proxy.rlwy.net:36200/railway"
}

model User {
  id        Int      @id @default(autoincrement())
  username  String   @db.VarChar(255)
  email     String   @unique @db.VarChar(255)
  password  String   @db.VarChar(255)
  isAdmin   Boolean  @default(false)
  createdAt DateTime @default(now())
  isActive  Boolean  @default(true)
  orders    Order[]

  @@map("user")
}

model Product {
  id            Int         @id @default(autoincrement())
  name          String      @db.VarChar(255)
  price         Int
  image         String      @db.VarChar(255)
  createdAt     DateTime    @default(now())
  cloudinary_id String?
  orderItems    OrderItem[]

  @@map("product")
}

model Order {
  id             Int       @id @default(autoincrement())
  user           User      @relation(fields: [userId], references: [id])
  userId         Int
  itemsPrice     Decimal   @db.Decimal(10,2)
  shippingPrice  Decimal   @db.Decimal(10,2)
  taxPrice       Decimal   @db.Decimal(10,2)
  totalPrice     Decimal   @db.Decimal(10,2)
  isPaid         Boolean   @default(false)
  paidAt         DateTime?
  isDelivered    Boolean   @default(false)
  deliveredAt    DateTime?
  invoiceNumber  String?   @unique
  createdAt      DateTime  @default(now())
  orderItems     OrderItem[]
}


model OrderItem {
  id        Int     @id @default(autoincrement())
  orderId   Int
  productId Int
  quantity  Int
  price     Decimal @db.Decimal(10, 2)
  order     Order   @relation(fields: [orderId], references: [id])
  product   Product @relation(fields: [productId], references: [id])

  @@unique([orderId, productId])
}
